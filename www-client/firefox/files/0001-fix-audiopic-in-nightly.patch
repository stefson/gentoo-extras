From 64d822a598f46f9d08a41eab6a7d416a6c54927b Mon Sep 17 00:00:00 2001
From: Mike Hommey <mh@glandium.org>
Date: Wed, 8 Jun 2022 16:03:49 +0900
Subject: [PATCH] Disable audio_thread_priority default features

with_dbus is supposed to be optional in gecko, but in practice, the
audio_thread_priority defaults force it on.
---
 audioipc/Cargo.toml | 1 +
 client/Cargo.toml   | 1 +
 server/Cargo.toml   | 1 +
 3 files changed, 3 insertions(+)

diff --git a/third_party/rust/audioipc/Cargo.toml b/third_party/rust/audioipc/Cargo.toml
index 0c409b8..ad59ed8 100644
--- a/third_party/rust/audioipc/Cargo.toml
+++ b/third_party/rust/audioipc/Cargo.toml
@@ -29,6 +29,7 @@ arrayvec = "0.7"
 
 [target.'cfg(target_os = "linux")'.dependencies.audio_thread_priority]
 version = "0.26.1"
+default-features = false
 
 [target.'cfg(windows)'.dependencies]
 winapi = { version = "0.3", features = ["combaseapi", "memoryapi", "objbase"] }
diff --git a/third_party/rust/audioipc-client/Cargo.toml b/third_party/rust/audioipc-client/Cargo.toml
index 8fb105e..c1c376d 100644
--- a/third_party/rust/audioipc-client/Cargo.toml
+++ b/third_party/rust/audioipc-client/Cargo.toml
@@ -16,3 +16,4 @@ log = "0.4"
 
 [dependencies.audio_thread_priority]
 version = "0.26.1"
+default-features = false
diff --git a/third_party/rust/server/Cargo.toml b/third_party/rust/server/Cargo.toml
index 8a578bf..c870b30 100644
--- a/third_party/rust/audioipc-server/Cargo.toml
+++ b/third_party/rust/audioipc-server/Cargo.toml
@@ -22,3 +22,4 @@ default-features = false
 
 [dependencies.audio_thread_priority]
 version = "0.26.1"
+default-features = false

